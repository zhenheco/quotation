# Proposal: relocate-company-button

## Summary
重新設計公司設定頁面的 UI/UX，包括：(1) 擴展 PageHeader 組件支援按鈕操作並整合「新增公司」功能，(2) 優化公司卡片的資訊架構和視覺層次，(3) 改善無障礙性和互動體驗。

## Why
基於 2024 年 UI/UX 最佳實踐和企業應用設計模式（參考 SAP Card UI、Shopify Polaris、WCAG 2.2），目前的公司設定頁面存在以下問題：

### 1. 按鈕放置不符合設計系統慣例
- 「新增公司」按鈕位於「我的公司」區塊內部的右上角，而非頁面層級的主要操作區域
- 根據 UX 最佳實踐，頁面層級的主要操作按鈕應整合在頁面 header 中，以保持一致性
- PageHeader 組件已支援 `action` prop，但目前未被使用
- 現有實作：按鈕在內容區塊內 → 理想狀態：按鈕在 PageHeader 作為主要操作

### 2. 公司卡片缺乏視覺層次和資訊架構
參考 SAP Card UI 和企業應用設計模式，優秀的卡片應包含清晰的資訊層次：
- **現況**：只顯示單一語言的公司名稱（依語系顯示中文或英文）
- **問題**：
  - 未建立視覺層次（size, color, typography）
  - 缺少關鍵識別資訊（統一編號），多公司場景下難以區分
  - 未同時顯示中英文名稱，使用者需切換語系才能看到完整資訊
  - 未遵循企業應用的卡片結構模式（header, body, footer）

### 3. 卡片狀態回饋不足
- **選中狀態**：只有邊框顏色變化（藍色邊框），視覺回饋不夠明顯
- **懸停狀態**：只有邊框顏色變化，缺少其他視覺提示（如背景色、陰影）
- **聚焦狀態**：未考慮鍵盤導航的視覺回饋
- **無障礙性**：缺少 ARIA 標籤支援螢幕閱讀器使用者

### 4. PageHeader 組件的限制
目前 PageHeader 的 `action` prop 只支援 Link 類型（`href`），無法處理需要 onClick 事件的按鈕操作（如新增公司），限制了組件的通用性。

## What Changes
1. **擴展 PageHeader 組件**：支援 button 類型的 action（onClick 事件）
2. **整合主要操作按鈕**：將「新增公司」功能整合到 PageHeader，符合頁面層級操作模式
3. **建立清晰的資訊層次**：按重要性排列公司資訊
   - 第一層（最顯眼）：中文公司名稱
   - 第二層（次要）：統一編號（括號標註）
   - 第三層（補充）：英文公司名稱
4. **增強視覺回饋**：改善選中、懸停、聚焦狀態的視覺設計，參考卡片 UI 最佳實踐
5. **提升無障礙性**：
   - 加入適當的 ARIA 屬性（`aria-label`, `aria-current`, `role`）
   - 支援鍵盤導航（Tab, Enter, Space）
   - 符合 WCAG 2.2 AA 標準
6. **優化響應式佈局**：確保在不同裝置上都有良好的顯示效果

## Non-Goals
- 不改變公司資料的儲存結構或資料庫 schema
- 不修改公司編輯表單的功能和欄位
- 不新增公司資料欄位或業務邏輯
- 不改變公司列表的排序或篩選邏輯
- 不實作公司搜尋或分頁功能（保留為未來擴展）
- 不修改 API 端點的路徑或回傳格式（只確認是否包含 `tax_id`）

## User Impact
### 正面影響
- **操作更直覺**：主要操作按鈕在頁面頂部，符合使用習慣
- **識別更容易**：透過統一編號和中英文名稱快速識別公司
- **視覺更清晰**：資訊層次分明，重要資訊更顯眼
- **互動更流暢**：明確的狀態回饋，更好的點擊和懸停體驗
- **無障礙更友善**：支援螢幕閱讀器和鍵盤導航

### 學習成本
- 低：按鈕位置改變，但更符合直覺，無需額外學習
- 卡片資訊更豐富，但佈局清晰，一目了然

## Stakeholders
- **系統管理員**：需要管理多個公司資料的使用者（主要受益者）
- **一般使用者**：需要切換不同公司進行操作的使用者
- **無障礙使用者**：使用螢幕閱讀器或鍵盤導航的使用者
- **開發團隊**：PageHeader 組件更通用，可重用於其他頁面

## Timeline
- **預估實作時間**：2-3 小時
  - PageHeader 組件擴展：30 分鐘
  - 公司卡片重構：1 小時
  - 無障礙性改善：30 分鐘
  - 測試與驗證：1 小時
- **依賴項**：確認 `/api/companies` 是否回傳 `tax_id` 欄位
- **風險**：低，只涉及 UI 層改動，不影響業務邏輯

## Alternatives Considered

### 1. 維持現狀
**選項**：不進行任何調整
**優點**：零開發成本
**缺點**：
- 不符合現代 UI/UX 最佳實踐
- 多公司場景下使用者體驗差
- 未充分利用現有的 PageHeader 組件能力
- 無障礙性不足

**決策**：❌ 不採用，問題會持續影響使用者體驗

### 2. 只調整按鈕位置
**選項**：將按鈕移動到 PageHeader 但不優化卡片
**優點**：實作簡單，快速見效
**缺點**：
- 無法解決公司識別困難的核心問題
- 未解決視覺層次不清的問題
- 投資回報率低，未充分改善 UX

**決策**：❌ 不採用，只解決表面問題

### 3. 使用下拉選單取代卡片列表
**選項**：類似 GitHub/Vercel 的組織切換器，使用下拉選單
**優點**：
- 節省空間，適合大量公司（10+ 個）
- 可加入搜尋功能
**缺點**：
- 無法一次瀏覽所有公司，需額外點擊
- 增加操作步驟（點擊 → 展開 → 選擇）
- 目前使用者通常只有 1-5 個公司，卡片列表更直觀
- 實作成本較高（需要下拉選單組件、搜尋邏輯）

**決策**：❌ 暫不採用，可作為未來擴展（當公司數量超過 10 個時）

### 4. 在 PageHeader 外部新增懸浮按鈕 (FAB)
**選項**：使用固定位置的懸浮操作按鈕（Floating Action Button）
**優點**：
- 始終可見，不受頁面捲動影響
- 適合移動端
**缺點**：
- 不符合桌面應用習慣（FAB 主要用於移動端 Material Design）
- 可能遮擋內容
- 與現有設計系統不一致（本專案未使用 FAB 模式）

**決策**：❌ 不採用，不符合當前設計系統

### 5. 將按鈕移到卡片列表上方但不整合到 PageHeader
**選項**：按鈕在「我的公司」標題和卡片列表之間
**優點**：靠近操作對象（公司列表）
**缺點**：
- 不符合設計系統慣例（主要操作應在 PageHeader）
- 與其他頁面不一致
- 未充分利用 PageHeader 組件

**決策**：❌ 不採用，不符合設計系統模式

**最終選擇**：整合到 PageHeader + 優化卡片設計
- 最符合當前設計系統和 UI/UX 最佳實踐
- 能充分利用現有組件，提升組件通用性
- 同時解決按鈕位置和卡片識別兩個核心問題
- 投資回報率高，改善多個使用者體驗維度

## Open Questions
### 已解決
- ✅ **PageHeader 是否支援 button 類型的 action？**
  - 答：目前只支援 Link (href)，需要擴展為支援 onClick 事件
  - 方案：新增 `onClick?: () => void` 到 action 定義

- ✅ **卡片選中狀態如何設計？**
  - 答：參考企業應用最佳實踐，使用明確的視覺層次
  - 方案：背景色 + 邊框 + 陰影組合

### 待確認
1. **API `/api/companies` 是否包含 `tax_id` 欄位？**
   - 需確認：檢查 API 回傳的 JSON 結構
   - 如果沒有：需要修改 API 以包含此欄位
   - 影響：如果 API 不包含，需要額外開發 API 修改工作

2. **是否需要支援鍵盤快捷鍵？**
   - 選項：如 Cmd/Ctrl + N 快速新增公司
   - 影響：提升進階使用者效率，但增加開發成本
   - 建議：暫不實作，保留為未來擴展

3. **在無公司時，是否顯示空狀態插圖？**
   - 選項：引導使用者新增第一個公司
   - 影響：改善首次使用體驗
   - 建議：建議實作，但可作為獨立任務
